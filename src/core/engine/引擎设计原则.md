# GraphEngine 设计原则

## 1. 单一职责
引擎只管**调度**，不管**业务**。

```
引擎知道 "如何" 操作节点（创建、删除、连接、布局）
引擎不知道 "是什么" 节点（具体类型、内容结构）
```

## 2. 开放封闭原则 (OCP)
- **对扩展开放**：添加新节点类型无需修改引擎
- **对修改封闭**：引擎核心逻辑稳定

## 3. 依赖倒置
引擎依赖**抽象接口**，不依赖**具体实现**。

```typescript
// ❌ 引擎硬编码具体类型
if (type === NodeType.SELECTOR) { ... }

// ✅ 引擎依赖抽象接口
const config = nodeRegistry.get(type);
const content = config.createDefaultContent();
```

## 4. 信息内聚
节点知识集中在**节点定义**中，不泄露到引擎。

```
nodes/
├── SelectorNode/
│   ├── index.tsx      # 渲染
│   ├── config.ts      # 默认内容、构建逻辑、元数据
│   └── Inspector.tsx  # 检查器
```

## 5. 分层架构

```
┌─────────────────────────────────────────┐
│  UI 层 (React 组件)                      │
├─────────────────────────────────────────┤
│  引擎层 (GraphEngine)                    │ ← 只做调度
├─────────────────────────────────────────┤
│  注册表层 (Registry)                     │ ← 元信息
├─────────────────────────────────────────┤
│  状态层 (Zustand Store)                  │ ← 纯数据
└─────────────────────────────────────────┘
```

## 核心约束

1. **禁止在引擎中出现 `switch(nodeType)` 或 `if(type === X)`**
2. **新增节点类型 = 新增节点文件，引擎零修改**
3. **节点特定逻辑通过 NodeConfig 工厂方法提供**
