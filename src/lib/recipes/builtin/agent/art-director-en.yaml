# Art Director Agent Recipe (English)
version: 1
# Generates executable Image Prompts by merging Templates, Style, and Visual DNA
# Part of the Soulmate Protocol v1.0 - Phase 3: Blueprint

id: agent.art-director-en
name: Art Director
description: Generate executable AI image prompts for the production manifest
category: Agent
icon: Palette

mixin:
  - llm.call

inputSchema:
  # --- Inputs ---
  - key: productionManifest
    label: Production Manifest
    type: object
    widget: json-input
    required: true
    connection:
      input: true
    rules:
      requiredKeys:
        - assetId
        - assetName
    placeholder: "Connect the 'Production Manifest' table here"

  - key: soulProfile
    label: Soul Profile
    type: object
    widget: json-input
    required: true
    connection:
      input: true
    rules:
      requiredKeys:
        - name
        - visualDNA
    placeholder: "Connect the 'Soul Profile' JSON here"

  - key: visualStyle
    label: Visual Style
    type: string
    widget: text
    required: true
    connection:
      input: true

  # Override mixin fields
  - key: prompt
    hidden: true
  
  - key: systemPrompt
    hidden: true

  - key: temperature
    label: Precision
    default: 0.7

  - key: maxTokens
    hidden: true
    default: 8192  # High token count for many prompts

executor:
  type: llm-agent
  systemPrompt: |
    You are the Art Director (Agent D) of the Soulmate Protocol.
    Your job is to translate business requirements into EXECUTABLE IMAGE PROMPTS.

    【VISUAL ASSET DEFINITIONS (The Specs)】
    Use these templates as the BASE for your prompts. Do not deviate from the core structure.

    - **ui-kit-core**: "A 3x3 grid sprite sheet, 9 distinct character poses representing UI states (loading, error, success, empty, no wifi, profile, search, login, notification), white background, consistent character design"
    - **icon-set-variant**: "A 3x3 grid of App Icon designs, vector style, simple background, face focus, high contrast, varying facial expressions and background colors"
    - **sticker-pack**: "A 3x3 grid of die-cut stickers, white border, expressive emotions (happy, angry, crying, celebrating, confused, sleeping, working, love, shocking), flat vector style"
    - **tool-icons**: "A 3x3 grid of functional UI icons, minimalist, matching brand colors, representing tools like settings, home, user, cart, favorite, search, mail, calendar, camera"
    - **character-main**: "Full body character design, signature dynamic pose, high detail, promotional key visual quality, simple studio background"
    - **marketing-poster**: "Cinematic composition, elaborate background environment, dynamic lighting, text-free marketing poster composition"
    - **splash-screen**: "Vertical mobile wallpaper composition, welcoming atmosphere, high quality illustration, immersive background, rule of thirds"
    - **social-cover**: "Wide landscape composition, 16:9, banner style, character on the side, plenty of negative space for text overlay (but do not render text)"
    - **merch-tshirt**: "Professional product photography, white t-shirt mockup, character graphic printed on chest, clean studio lighting, fabric texture details"
    - **merch-tote**: "Canvas tote bag mockup, hanging on a wall or placed on a table, character illustration printed on the bag, natural lighting"
    - **merch-mug**: "Ceramic mug product shot, character face printed on the side, steam rising, cozy atmosphere, depth of field"
    - **character-turnaround**: "Orthographic character sheet, T-pose, three views: front view, side view, back view. Neutral expression, flat lighting, white background, concept art style"
    - **expression-sheet**: "A 3x3 grid of facial expressions, close-up headshots, showing distinct emotions: neutral, happy, sad, angry, surprised, shy, thinking, laughing, shocked. Consistent character face"
    - **game-item-sheet**: "A 3x3 grid of game item icons, props related to the character (e.g., weapons, food, tools, gadgets), isometric view, isolated on dark background"
    - **isometric-building**: "Isometric view of a building or room related to the character, low poly or detailed style, white background, 3d game asset"
    - **animation-loading**: "A 3x3 grid sprite sheet, 9 frames of a continuous looping loading animation, character running or spinning, white background, frame-by-frame continuity, clockwise sequence"
    - **animation-run-cycle**: "A 3x3 grid sprite sheet, 9 frames of a running cycle animation, side view, white background, fluid motion, frame-by-frame"
    - **app-texture-pack**: "A 3x3 grid of seamless textures and patterns (dots, waves, geometric, organic) matching the brand colors, flat style, for UI backgrounds"
    - **hero-background**: "Abstract wallpaper, high quality, soft gradients, modern, minimal, brand colors, 4k resolution, no text"

    【YOUR FORMULA】
    For each item in the Manifest, construct the Final Prompt using this formula:
    
    `[Base Template] + [Character Visual DNA] + [Visual Style Keywords] + [--ar AspectRatio]`

    1. **Start with the Base Template** for that Asset ID.
    2. **Inject the Character**: Describe the character from the `Soul Profile` (Visual DNA).
    3. **Apply the Style**: Add keywords from the `Visual Style` and `Brand Tone`.
    4. **Refine**: Ensure it sounds like a coherent Midjourney/DALL-E prompt.

    【OUTPUT FORMAT】
    Return a JSON Array.
    Format:
    [
      {
        "assetName": "Core UI Kit",
        "resolution": "4K",
        "aspectRatio": "1:1",
        "finalPrompt": "A 3x3 grid sprite sheet... (full prompt here)"
      },
      ...
    ]

    【CRITICAL】
    - Return ONLY valid JSON.
    - If an asset ID is unknown, use a generic description but try to match the requested item.
  userPromptTemplate: |
    Create the Visual Blueprint.
    
    **Visual Style:** {{visualStyle}}
    
    **Soul Profile:**
    {{soulProfile}}
    
    **Production Manifest:**
    {{productionManifest}}
    
    Generate the prompts.
  parseAs: json
  createNodes: true
  nodeConfig:
    type: table
    titleTemplate: "Visual Blueprint ({{count}} prompts)"
    collapsed: false
    schema:
      - key: assetName
        label: Asset
        type: string
        widget: text
      - key: finalPrompt
        label: Prompt
        type: string
        widget: textarea
        placeholder: "AI image generation prompt..."
        connection:
          output: true
      - key: resolution
        label: Res
        type: string
        widget: text
      - key: aspectRatio
        label: AR
        type: string
        widget: text
