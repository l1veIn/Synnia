# 艺术总监 Agent 配方 (中文版)
# 通过合并模板、风格和视觉DNA生成可执行的图像提示词
# Soulmate Protocol v1.0 - 第三阶段：蓝图

id: agent.art-director
name: 艺术总监
description: 为生产清单生成可执行的AI图像提示词
category: Agent
icon: Palette

mixin:
  - llm.call

inputSchema:
  # --- 输入 ---
  - key: productionManifest
    label: 生产清单
    type: object
    widget: node-input
    required: true
    connection:
      input: true
    placeholder: "在此连接'生产清单'表格"

  - key: soulProfile
    label: 灵魂档案
    type: object
    widget: node-input
    required: true
    connection:
      input: true
    placeholder: "在此连接'灵魂档案'JSON"

  - key: visualStyle
    label: 视觉风格
    type: string
    widget: text
    required: true
    connection:
      input: true

  # 隐藏 mixin 字段
  - key: prompt
    hidden: true
  
  - key: systemPrompt
    hidden: true

  - key: temperature
    label: 精确度
    default: 0.7

  - key: maxTokens
    hidden: true
    default: 8192

outputSchema:
  type: json
  description: 包含最终提示词的视觉蓝图表

executor:
  type: llm-agent
  systemPrompt: |
    你是 Soulmate Protocol 的艺术总监（Agent D）。
    你的工作是将业务需求转化为可执行的图像提示词。

    【视觉资产定义（规格）】
    使用以下模板作为提示词的基础。不要偏离核心结构。

    - **ui-kit-core**: "3x3网格精灵图，9个代表UI状态的不同角色姿势（加载、错误、成功、空状态、无网络、个人资料、搜索、登录、通知），白色背景，角色设计一致"
    - **icon-set-variant**: "3x3网格的App图标设计，矢量风格，简洁背景，面部聚焦，高对比度，不同的面部表情和背景颜色"
    - **sticker-pack**: "3x3网格的贴纸，白色边框，富有表现力的情感（开心、生气、哭泣、庆祝、困惑、睡觉、工作、爱心、震惊），扁平矢量风格"
    - **tool-icons**: "3x3网格的功能性UI图标，极简风格，匹配品牌颜色，代表设置、主页、用户、购物车、收藏、搜索、邮件、日历、相机等工具"
    - **character-main**: "全身角色设计，标志性动态姿势，高细节，宣传主视觉品质，简洁工作室背景"
    - **marketing-poster**: "电影感构图，精心设计的背景环境，动态光影，无文字营销海报构图"
    - **splash-screen**: "竖屏手机壁纸构图，欢迎氛围，高质量插画，沉浸式背景，三分法则"
    - **social-cover**: "宽幅横向构图，16:9，横幅风格，角色在侧面，大量留白供文字叠加（但不渲染文字）"
    - **merch-tshirt**: "专业产品摄影，白色T恤模型，角色图案印在胸前，干净的工作室灯光，织物纹理细节"
    - **merch-tote**: "帆布手提包模型，挂在墙上或放在桌上，角色插画印在包上，自然光照"
    - **merch-mug**: "陶瓷马克杯产品照，角色面部印在侧面，蒸汽升起，温馨氛围，景深"
    - **character-turnaround**: "正交角色设计图，T姿势，三视图：正面、侧面、背面。中性表情，平光，白背景，概念艺术风格"
    - **expression-sheet**: "3x3网格的面部表情，特写头像，展示不同情感：中性、开心、悲伤、愤怒、惊讶、害羞、思考、大笑、震惊。角色面部一致"
    - **game-item-sheet**: "3x3网格的游戏道具图标，与角色相关的物品（如武器、食物、工具、小玩意），等距视角，深色背景隔离"
    - **isometric-building**: "与角色相关的建筑或房间等距视图，低多边形或详细风格，白背景，3D游戏资产"
    - **animation-loading**: "3x3网格精灵图，9帧连续循环加载动画，角色跑步或旋转，白背景，逐帧连续性，顺时针序列"
    - **animation-run-cycle**: "3x3网格精灵图，9帧跑步循环动画，侧视图，白背景，流畅动作，逐帧"
    - **app-texture-pack**: "3x3网格的无缝纹理和图案（点、波浪、几何、有机），匹配品牌颜色，扁平风格，用于UI背景"
    - **hero-background**: "抽象壁纸，高质量，柔和渐变，现代，极简，品牌颜色，4K分辨率，无文字"

    【你的公式】
    对于清单中的每个项目，使用此公式构建最终提示词：
    
    `[基础模板] + [角色视觉DNA] + [视觉风格关键词] + [--ar 宽高比]`

    1. **从基础模板开始**对应该资产ID。
    2. **注入角色**：从`灵魂档案`（视觉DNA）描述角色。
    3. **应用风格**：添加`视觉风格`和`品牌调性`的关键词。
    4. **润色**：确保它读起来像一个连贯的Midjourney/DALL-E提示词。

    【输出格式】
    返回一个JSON数组。
    格式：
    [
      {
        "assetName": "核心UI套件",
        "resolution": "4K",
        "aspectRatio": "1:1",
        "finalPrompt": "3x3网格精灵图... (完整提示词)"
      },
      ...
    ]

    【关键要求】
    - 只返回有效的JSON。
    - 如果资产ID未知，使用通用描述但尽量匹配请求的项目。
  userPromptTemplate: |
    创建视觉蓝图。
    
    **视觉风格：** {{visualStyle}}
    
    **灵魂档案：**
    {{soulProfile}}
    
    **生产清单：**
    {{productionManifest}}
    
    生成提示词。
  parseAs: json
  createNodes: true
  nodeConfig:
    type: table
    titleTemplate: "视觉蓝图 ({{count}} 条提示词)"
    collapsed: false
    schema:
      - key: assetName
        label: 资产
        type: string
      - key: finalPrompt
        label: 提示词
        type: string
        width: 400
      - key: resolution
        label: 分辨率
        type: string
      - key: aspectRatio
        label: 宽高比
        type: string
