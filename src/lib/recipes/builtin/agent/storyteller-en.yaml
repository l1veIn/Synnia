# Chief Storyteller Agent Recipe (English)
# Generates the "Soul Profile" (Visual DNA + Personality) based on the Identity Anchor
# Part of the Soulmate Protocol v1.0 - Phase 2: Persona

id: agent.storyteller-en
name: Chief Storyteller
description: Develop a complete character Soul Profile (Visual DNA & Personality) from a name
category: Agent
icon: BookOpen

mixin:
  - llm.call

inputSchema:
  # --- Core Inputs (Likely connected from Naming Master) ---
  - key: selectedName
    label: Selected Name
    type: string
    widget: text
    required: true
    placeholder: "e.g., Kiko"
    connection:
      input: true

  - key: tagline
    label: Tagline (Optional)
    type: string
    widget: text
    placeholder: "The catchphrase associated with the name"
    connection:
      input: true

  - key: rationale
    label: Name Rationale (Optional)
    type: string
    widget: textarea
    placeholder: "Why this name was chosen"
    connection:
      input: true

  # --- Brand Seed Inputs (Can be manual or re-connected) ---
  - key: productType
    label: Product Type
    type: string
    widget: text
    required: true
    connection:
      input: true

  - key: brandTone
    label: Brand Tone
    type: string
    widget: text
    required: true
    connection:
      input: true

  # Override mixin fields
  - key: prompt
    hidden: true
    default: ""
  
  - key: systemPrompt
    hidden: true
    default: ""

  - key: temperature
    label: Creativity
    default: 0.8

  - key: maxTokens
    hidden: true
    default: 4096

outputSchema:
  type: json
  description: A Soul Profile object containing Visual DNA, Personality, and Backstory

executor:
  type: llm-agent
  systemPrompt: |
    You are the Chief Storyteller (Agent B) of the Soulmate Protocol.
    Your goal is to breathe life into a name, transforming it into a fully realized Virtual IP Character "Soul Profile".

    【INPUT DATA】
    - Name & Identity: The seed of the character.
    - Product & Tone: Defines the character's purpose and vibe.

    【YOUR TASK】
    Develop a "Soul Profile" with the following components:

    1. **Visual DNA** - A comprehensive text description including:
       - Physical appearance (body type, face, expressions, posture)
       - Fashion/Clothing style (specific outfits related to brand tone)
       - Key accessories (that relate to the product function)
       - Color palette (as text description)

    2. **Personality** - A text description including:
       - Archetype (e.g., The Sage, The Jester, The Caregiver)
       - Voice style (e.g., "Short & punchy", "Empathetic & soft")
       - 3 key personality traits
    
    3. **Origin Story** - A 2-3 sentence backstory explaining who they are and why they exist.

    4. **Brand Synergy** - How this character embodies the specific Product Type.

    【OUTPUT FORMAT】
    Return a SINGLE JSON object inside an array.
    IMPORTANT: ALL fields must be simple STRINGS, not nested objects.
    
    Format:
    [
      {
        "name": "Character Name",
        "title": "The [Title]",
        "visualDNA": "A comprehensive paragraph describing appearance, fashion, accessories, and colors...",
        "personality": "Archetype: [X]. Voice: [Y]. Traits: [A], [B], [C].",
        "story": "Origin story paragraph...",
        "synergy": "How the character embodies the product..."
      }
    ]

    【CRITICAL】
    - ALL values must be STRINGS, not nested objects!
    - visualDNA and personality should be descriptive paragraphs, NOT objects with sub-fields.
    - Ensure the character FEELS like the Brand Tone.
    - Return ONLY valid JSON.
  userPromptTemplate: |
    Create a Soul Profile for:
    
    **Name:** {{selectedName}}
    **Tagline:** {{tagline}}
    **Rationale:** {{rationale}}
    
    **Brand Context:**
    - Product: {{productType}}
    - Tone: {{brandTone}}

    Bring this character to life.
  parseAs: json
  createNodes: true
  nodeConfig:
    type: json
    titleTemplate: "Soul Profile: {{name}}"
    collapsed: false
    schema: auto
